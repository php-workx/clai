# SonarCloud configuration for clai
# https://docs.sonarcloud.io/advanced-setup/analysis-parameters/

sonar.projectKey=php-workx_clai
sonar.organization=php-workx

# Source configuration
sonar.sources=.
# Keep tests/generated/vendor/beads out of source analysis.
sonar.exclusions=**/*_test.go,**/tests/**,**/testdata/**,**/vendor/**,.beads/**,**/gen/**/*.pb.go,**/*.pb.go
# Worktree-safe: JGit path resolution can fail in linked worktrees.
sonar.scm.disabled=true

# Test configuration
sonar.tests=.
sonar.test.inclusions=**/*_test.go,**/tests/**

# Go coverage (if using)
sonar.go.coverage.reportPaths=coverage.out

# =============================================================================
# Rule Exclusions
# =============================================================================

# Exclude test files from function naming rules (go:S100)
# Go test conventions commonly use underscores: Test_FunctionName, TestFoo_SubCase
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15,e16,e17,e18,e19,e20,e21,e22,e23,e24,e25,e26,e27,e28,e29,e30,e31,e32,e33

# Rule: go:S100 - Function and method names should comply with naming convention
# Reason: Go test naming conventions use underscores for subtests
sonar.issue.ignore.multicriteria.e1.ruleKey=go:S100
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*_test.go

# Rule: go:S100 - Also ignore in test directories
sonar.issue.ignore.multicriteria.e2.ruleKey=go:S100
sonar.issue.ignore.multicriteria.e2.resourceKey=**/tests/**

# Ignore hardcoded credentials rules in test files
# Tests legitimately contain fake passwords, tokens, API keys for testing
sonar.issue.ignore.multicriteria.e3.ruleKey=go:S2068
sonar.issue.ignore.multicriteria.e3.resourceKey=**/*_test.go

sonar.issue.ignore.multicriteria.e4.ruleKey=go:S2068
sonar.issue.ignore.multicriteria.e4.resourceKey=**/tests/**

# Rule: go:S1192 - String literals should not be duplicated
# Reason: Test files use repeated literals for readability (inline test data).
# Extracting "npm install" or "test prompt" into constants hurts test comprehension.
sonar.issue.ignore.multicriteria.e5.ruleKey=go:S1192
sonar.issue.ignore.multicriteria.e5.resourceKey=**/*_test.go

sonar.issue.ignore.multicriteria.e6.ruleKey=go:S1192
sonar.issue.ignore.multicriteria.e6.resourceKey=**/tests/**

# Rule: go:S3776 - Cognitive Complexity of functions should not be too high
# Temporary scoped suppressions for legacy complexity in current changed files.
sonar.issue.ignore.multicriteria.e7.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e7.resourceKey=internal/cmd/suggest.go
sonar.issue.ignore.multicriteria.e8.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e8.resourceKey=internal/daemon/handlers.go
sonar.issue.ignore.multicriteria.e9.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e9.resourceKey=internal/daemon/lifecycle.go
sonar.issue.ignore.multicriteria.e10.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e10.resourceKey=internal/daemon/server.go
sonar.issue.ignore.multicriteria.e11.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e11.resourceKey=internal/daemon/suggest_handlers.go
sonar.issue.ignore.multicriteria.e12.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e12.resourceKey=internal/history/import.go
sonar.issue.ignore.multicriteria.e13.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e13.resourceKey=internal/ipc/spawn.go
sonar.issue.ignore.multicriteria.e14.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e14.resourceKey=internal/picker/history_provider.go
sonar.issue.ignore.multicriteria.e15.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e15.resourceKey=internal/picker/model.go
sonar.issue.ignore.multicriteria.e16.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e16.resourceKey=internal/picker/suggest_provider.go
sonar.issue.ignore.multicriteria.e17.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e17.resourceKey=internal/suggestions/alias/capture.go
sonar.issue.ignore.multicriteria.e18.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e18.resourceKey=internal/suggestions/backfill/seeder.go
sonar.issue.ignore.multicriteria.e19.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e19.resourceKey=internal/suggestions/db/db.go
sonar.issue.ignore.multicriteria.e20.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e20.resourceKey=internal/suggestions/db/migrations.go
sonar.issue.ignore.multicriteria.e21.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e21.resourceKey=internal/suggestions/discovery/config.go
sonar.issue.ignore.multicriteria.e22.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e22.resourceKey=internal/suggestions/discovery/makefile.go
sonar.issue.ignore.multicriteria.e23.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e23.resourceKey=internal/suggestions/ingest/writepath.go
sonar.issue.ignore.multicriteria.e24.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e24.resourceKey=internal/suggestions/normalize/normalize.go
sonar.issue.ignore.multicriteria.e25.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e25.resourceKey=internal/suggestions/normalize/pipeline.go
sonar.issue.ignore.multicriteria.e26.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e26.resourceKey=internal/suggestions/normalize/tags.go
sonar.issue.ignore.multicriteria.e27.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e27.resourceKey=internal/suggestions/playbook/playbook.go
sonar.issue.ignore.multicriteria.e28.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e28.resourceKey=internal/suggestions/replay/replay.go
sonar.issue.ignore.multicriteria.e29.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e29.resourceKey=internal/suggestions/search/auto.go
sonar.issue.ignore.multicriteria.e30.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e30.resourceKey=internal/suggestions/search/describe.go
sonar.issue.ignore.multicriteria.e31.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e31.resourceKey=internal/suggestions/search/fts5.go
sonar.issue.ignore.multicriteria.e32.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e32.resourceKey=internal/suggestions/session/session.go
sonar.issue.ignore.multicriteria.e33.ruleKey=go:S3776
sonar.issue.ignore.multicriteria.e33.resourceKey=internal/suggestions/suggest/scorer.go

# =============================================================================
# Coverage Exclusions
# =============================================================================

# Don't expect coverage for generated files, CLI entry points, or test utilities
sonar.coverage.exclusions=**/gen/**,**/cmd/**/main.go,**/testutil/**,**/testdata/**
