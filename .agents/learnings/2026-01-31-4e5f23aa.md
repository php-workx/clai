# Learning: Fish Shell Function Existence Checks

**ID**: L1
**Category**: testing
**Confidence**: high

## What We Learned

When testing Fish shell integration with expect-style tests, use `functions -q <name>` to check if a function exists. This returns a status code without verbose output, making it easy to match with echo markers (`FUNC_EXISTS` / `FUNC_MISSING`) in expect tests.

## Why It Matters

Avoids flaky tests caused by parsing verbose `functions` command output; clean status codes are reliable for automation.

## Source

Session: 4e5f23aa-e9c5-4794-a4e9-dc8a9fa60385

---

# Learning: Hook File Path Resolution

**ID**: L2
**Category**: debugging
**Confidence**: high

## What We Learned

The `FindHookFile` helper was constructing wrong paths by not properly parsing the shell name from the file extension. The fix required parsing the shell name and using the correct directory structure (`internal/cmd/shell/<shell>/clai.<shell>`).

## Why It Matters

Correct path resolution is critical for integration tests that source shell hook files; wrong paths cause silent test failures.

## Source

Session: 4e5f23aa-e9c5-4794-a4e9-dc8a9fa60385
