# Learning: Session ID Persistence Across Shell Re-sourcing

**ID**: L1
**Category**: architecture
**Confidence**: high

## What We Learned

When implementing session-scoped features (like command history isolation), environment variables set during shell initialization must check if they're already set before generating new values. Otherwise, re-sourcing `.zshrc`/`.bashrc` will create new session IDs, breaking the isolation guarantee.

## Why It Matters

Session isolation is only meaningful if the session ID persists for the lifetime of the shell process, not just until the next `source ~/.zshrc`.

## Source

Session: 774d73e4-2cf6-4a9a-b0d6-f4b638613d42

---

# Learning: Query Scope Consistency

**ID**: L2
**Category**: architecture
**Confidence**: high

## What We Learned

When adding session-based filtering to one query scope (e.g., CWD-scoped history), consider whether other scopes (e.g., Global) should also be session-scoped for consistency. Mixed behavior creates confusing UX where some results are isolated and others aren't.

## Why It Matters

Consistent behavior across related features reduces user confusion and makes the system more predictable.

## Source

Session: 774d73e4-2cf6-4a9a-b0d6-f4b638613d42
