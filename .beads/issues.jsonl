{"id":"ai-terminal-0zs","title":"Shell UX Enhancements","description":"Advanced shell integration features for improved command completion and history navigation. These are higher complexity features that require deep shell integration.","status":"open","priority":3,"issue_type":"epic","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:08:30.256491+01:00","created_by":"Ronny Unger","updated_at":"2026-01-28T19:08:30.256491+01:00"}
{"id":"ai-terminal-3xh","title":"Command suggestion while typing (history matching)","description":"Show command suggestions as user types, matching against command history.\n\n**Inspiration:** Fish shell's autosuggestions, zsh-autosuggestions plugin\n\n**Technical approach:**\n1. ZLE widget hooked to every keystroke (zle -N self-insert)\n2. Parse shell history file (~/.zsh_history, ~/.bash_history)\n3. Fuzzy match current BUFFER against history\n4. Display suggestion in dim text after cursor (POSTDISPLAY in Zsh)\n5. Tab or right-arrow to accept\n\n**Complexity:** High - requires efficient history indexing, per-keystroke performance\n\n**Files:**\n- internal/cmd/shell/zsh/clai.zsh - ZLE hooks\n- internal/cmd/shell/bash/clai.bash - readline integration\n- internal/cmd/shell/fish/clai.fish - Fish already has this, may just enable\n\n**Research needed:**\n- Performance impact of history search on every keystroke\n- How zsh-autosuggestions handles large history files\n- Whether to cache/index history","status":"closed","priority":3,"issue_type":"feature","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:08:42.400012+01:00","created_by":"Ronny Unger","updated_at":"2026-01-29T17:54:07.22547+01:00","closed_at":"2026-01-29T17:54:07.22547+01:00","close_reason":"Implemented inline history suggestions using POSTDISPLAY. Right-arrow to accept.","dependencies":[{"issue_id":"ai-terminal-3xh","depends_on_id":"ai-terminal-0zs","type":"parent-child","created_at":"2026-01-28T19:09:13.095286+01:00","created_by":"Ronny Unger"}]}
{"id":"ai-terminal-4gx","title":"Add 'Run X to Y' extraction pattern","description":"Commands like 'Run bd doctor --fix to see details' aren't extracted because Pattern 3 requires a colon (Run: X).\n\n**Solution:** Add new pattern to match 'Run \u003ccommand\u003e to \u003caction\u003e' format.\n\n**Files:**\n- internal/extract/extract.go - Add pattern\n- internal/extract/extract_test.go - Add test cases\n\n**Acceptance:** 'Run bd doctor --fix to see details' extracts 'bd doctor --fix'","notes":"On hold per user request","status":"open","priority":4,"issue_type":"bug","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:05:04.161921+01:00","created_by":"Ronny Unger","updated_at":"2026-01-29T16:59:38.291786+01:00","dependencies":[{"issue_id":"ai-terminal-4gx","depends_on_id":"ai-terminal-b0k","type":"parent-child","created_at":"2026-01-28T19:05:48.170198+01:00","created_by":"Ronny Unger"}]}
{"id":"ai-terminal-69m","title":"Add model selection support (Haiku/Sonnet)","description":"All queries use Claude CLI default model. Want Haiku for fast voice commands, Sonnet for complex diagnosis.\n\n**Solution:**\n1. Add CLAI_MODEL_VOICE and CLAI_MODEL_DIAGNOSE env vars\n2. Pass --model flag to Claude CLI when set\n3. Default: Haiku for voice, Sonnet for diagnose\n\n**Files:**\n- internal/claude/claude.go - Add model parameter to Query functions\n- internal/claude/daemon.go - Model in daemon requests\n- internal/cmd/voice.go - Use voice model\n- internal/cmd/diagnose.go - Use diagnose model\n\n**Acceptance:** CLAI_MODEL_VOICE=haiku uses Haiku for voice commands.","notes":"Implemented: Daemon uses Haiku model. Benchmarked Haiku vs Sonnet (1.28x faster). Model switching mid-session not possible in stream-json mode.","status":"closed","priority":2,"issue_type":"feature","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:05:16.358896+01:00","created_by":"Ronny Unger","updated_at":"2026-01-29T17:37:06.471636+01:00","closed_at":"2026-01-29T17:37:06.471636+01:00","close_reason":"Implemented: Daemon uses Haiku model for fast voice commands. Benchmarked 1.28x faster than Sonnet with equivalent quality.","dependencies":[{"issue_id":"ai-terminal-69m","depends_on_id":"ai-terminal-b0k","type":"parent-child","created_at":"2026-01-28T19:05:48.353461+01:00","created_by":"Ronny Unger"}]}
{"id":"ai-terminal-9fr","title":"Fix Tab suggestion cleared prematurely","description":"clai extract overwrites suggestion file even when no pattern matches, clearing previous AI suggestions.\n\n**Solution:** Only write to suggestion cache if a non-empty suggestion was found. Preserve existing suggestion otherwise.\n\n**Files:**\n- internal/cmd/extract.go - Conditional cache write\n\n**Acceptance:** Previous suggestion persists when new command has no extractable suggestion.","status":"open","priority":2,"issue_type":"bug","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:05:10.183394+01:00","created_by":"Ronny Unger","updated_at":"2026-01-28T19:05:10.183394+01:00","dependencies":[{"issue_id":"ai-terminal-9fr","depends_on_id":"ai-terminal-b0k","type":"parent-child","created_at":"2026-01-28T19:05:48.260835+01:00","created_by":"Ronny Unger"},{"issue_id":"ai-terminal-9fr","depends_on_id":"ai-terminal-4gx","type":"blocks","created_at":"2026-01-28T19:05:54.478033+01:00","created_by":"Ronny Unger"}]}
{"id":"ai-terminal-9gz","title":"Fix Escape key not stopping AI analysis","description":"Two-part fix for interrupting AI analysis:\n\n**Part 1: Documentation (quick win)**\nDocument that Ctrl+C interrupts AI analysis. Update README and shell script comments.\n\n**Part 2: Implement ESC interrupt (investigate)**\nResearch and implement ESC key to interrupt running clai processes and return to terminal.\n\n**Technical context:**\n- Ctrl+C already works (Go context.Context cancellation)\n- ESC is intercepted by shell (ZLE in Zsh) before reaching clai process\n- Shell can't easily send SIGINT to backgrounded subprocess\n\n**Research needed for Part 2:**\n- Can ZLE widget send signal to specific PID?\n- Store clai PID in temp file, ESC handler reads and kills?\n- Or: clai polls a cancel file while waiting for Claude response?\n\n**Files:**\n- README.md - Document Ctrl+C\n- internal/cmd/shell/zsh/clai.zsh - ESC binding + PID tracking\n- internal/cmd/shell/bash/clai.bash - trap + PID tracking\n- internal/cmd/shell/fish/clai.fish - bind escape + PID tracking\n- Possibly: internal/claude/claude.go - poll cancel file\n\n**Acceptance:** \n- README documents Ctrl+C for interruption\n- ESC key stops running analysis and returns to prompt (if feasible)","notes":"On hold per user request","status":"open","priority":4,"issue_type":"bug","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:05:22.896834+01:00","created_by":"Ronny Unger","updated_at":"2026-01-29T16:59:40.625654+01:00","dependencies":[{"issue_id":"ai-terminal-9gz","depends_on_id":"ai-terminal-b0k","type":"parent-child","created_at":"2026-01-28T19:05:48.445601+01:00","created_by":"Ronny Unger"}]}
{"id":"ai-terminal-b0k","title":"CLAI Improvements","description":"Bug fixes and model selection feature for clai. Covers extraction patterns, suggestion caching, model selection, and diagnosis improvements.","status":"open","priority":1,"issue_type":"epic","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:04:26.732732+01:00","created_by":"Ronny Unger","updated_at":"2026-01-28T19:04:26.732732+01:00"}
{"id":"ai-terminal-b1g","title":"Prevent repetitive error suggestions","description":"Error analysis suggests the same fix repeatedly (e.g., always says 'install requests' even after user tried).\n\n**Solution:**\n1. Cache last N diagnosis results with command hash\n2. Include previous suggestions in prompt context\n3. Add 'I already tried X' awareness\n\n**Files:**\n- internal/cmd/diagnose.go - History-aware prompting\n- internal/cache/cache.go - Add diagnosis history cache\n\n**Acceptance:** Re-running diagnosis for same error provides alternative suggestions.","status":"open","priority":3,"issue_type":"bug","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:05:28.962972+01:00","created_by":"Ronny Unger","updated_at":"2026-01-28T19:05:28.962972+01:00","dependencies":[{"issue_id":"ai-terminal-b1g","depends_on_id":"ai-terminal-b0k","type":"parent-child","created_at":"2026-01-28T19:05:48.535181+01:00","created_by":"Ronny Unger"}]}
{"id":"ai-terminal-c8h","title":"Per-tab command history","description":"Maintain separate command history per terminal tab/session, so arrow-up shows commands from current context.\n\n**Problem:** Global history mixes commands from different projects/contexts\n\n**Technical approach:**\n1. Detect terminal tab/session identifier:\n   - $TERM_SESSION_ID (iTerm2)\n   - $KITTY_WINDOW_ID (Kitty)\n   - $GHOSTTY_RESOURCES_DIR + PID (Ghostty)\n   - $TMUX_PANE (tmux)\n   - Fallback: TTY device (/dev/ttys001)\n2. Store history in per-session files: ~/.cache/clai/history/\u003csession-id\u003e\n3. Merge with global history on session end (optional)\n\n**Complexity:** Medium - mostly configuration and file management\n\n**Challenges:**\n- Different terminal emulators use different env vars\n- Session ID persistence across shell restarts\n- History file cleanup for old sessions\n\n**Files:**\n- internal/cmd/shell/zsh/clai.zsh - HISTFILE override\n- internal/cmd/shell/bash/clai.bash - HISTFILE override  \n- internal/cmd/shell/fish/clai.fish - fish_history variable\n- New: internal/cmd/history.go - Session detection logic","notes":"On hold per user request","status":"open","priority":4,"issue_type":"feature","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:09:06.208707+01:00","created_by":"Ronny Unger","updated_at":"2026-01-29T16:59:39.646024+01:00","dependencies":[{"issue_id":"ai-terminal-c8h","depends_on_id":"ai-terminal-0zs","type":"parent-child","created_at":"2026-01-28T19:09:13.275242+01:00","created_by":"Ronny Unger"}]}
{"id":"ai-terminal-nja","title":"Arrow-up history preview (show last N matches)","description":"When pressing arrow-up, show a preview of the last 5 commands matching current input instead of cycling one-by-one.\n\n**Inspiration:** fzf history search, atuin shell history\n\n**Technical approach:**\n1. Override up-arrow ZLE widget (up-line-or-history)\n2. If BUFFER is non-empty, show dropdown/overlay with matching history\n3. Use Zsh's zle -M for message display or POSTDISPLAY\n4. Arrow keys navigate, Enter selects\n5. Escape cancels\n\n**Complexity:** High - requires overlay/popup UI in terminal\n\n**Challenges:**\n- Terminal doesn't have native popup/dropdown support\n- Need to handle terminal resize, scrollback\n- May need to clear/restore display after selection\n\n**Alternative:** Integrate with fzf if available (fzf --history)\n\n**Files:**\n- internal/cmd/shell/zsh/clai.zsh - ZLE widget\n- internal/cmd/shell/bash/clai.bash - bind -x for up-arrow\n- internal/cmd/shell/fish/clai.fish - bind up for fish","notes":"On hold per user request","status":"open","priority":4,"issue_type":"feature","owner":"phpworkx@gmail.com","created_at":"2026-01-28T19:08:53.733901+01:00","created_by":"Ronny Unger","updated_at":"2026-01-29T16:59:41.816456+01:00","dependencies":[{"issue_id":"ai-terminal-nja","depends_on_id":"ai-terminal-0zs","type":"parent-child","created_at":"2026-01-28T19:09:13.187737+01:00","created_by":"Ronny Unger"}]}
