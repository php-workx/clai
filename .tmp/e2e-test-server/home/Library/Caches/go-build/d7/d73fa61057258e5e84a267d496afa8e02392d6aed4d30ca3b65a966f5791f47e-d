=== RUN   TestConfig_ApplyDefaults
--- PASS: TestConfig_ApplyDefaults (0.00s)
=== NAME  
=== RUN   TestConfig_ApplyDefaults_NegativeRetentionDays
--- PASS: TestConfig_ApplyDefaults_NegativeRetentionDays (0.00s)
=== NAME  
=== RUN   TestConfig_PreservesUserValues
--- PASS: TestConfig_PreservesUserValues (0.00s)
=== NAME  
=== RUN   TestNewRunner
--- PASS: TestNewRunner (0.02s)
=== NAME  
=== RUN   TestWALCheckpoint_LowActivity
--- PASS: TestWALCheckpoint_LowActivity (0.02s)
=== NAME  
=== RUN   TestWALCheckpoint_HighActivity
--- PASS: TestWALCheckpoint_HighActivity (0.02s)
=== NAME  
=== RUN   TestRetentionPrune_DeletesOldRows
2026/02/20 09:31:27 INFO retention prune completed deleted=5 cutoff_ms=1763800287239
--- PASS: TestRetentionPrune_DeletesOldRows (0.03s)
=== NAME  
=== RUN   TestRetentionPrune_BatchProcessing
2026/02/20 09:31:27 INFO retention prune completed deleted=10 cutoff_ms=1763800287265
--- PASS: TestRetentionPrune_BatchProcessing (0.03s)
=== NAME  
=== RUN   TestRetentionPrune_DisabledWhenZero
--- PASS: TestRetentionPrune_DisabledWhenZero (0.02s)
=== NAME  
=== RUN   TestRetentionPrune_NoOldRows
--- PASS: TestRetentionPrune_NoOldRows (0.02s)
=== NAME  
=== RUN   TestRetentionPrune_CancelledContext
--- PASS: TestRetentionPrune_CancelledContext (0.02s)
=== NAME  
=== RUN   TestRetentionPrune_EmptyDB
--- PASS: TestRetentionPrune_EmptyDB (0.01s)
=== NAME  
=== RUN   TestCleanOrphanedTemplates_RemovesOrphans
--- PASS: TestCleanOrphanedTemplates_RemovesOrphans (0.02s)
=== NAME  
=== RUN   TestCleanOrphanedTemplates_NoOrphans
--- PASS: TestCleanOrphanedTemplates_NoOrphans (0.02s)
=== NAME  
=== RUN   TestCleanOrphanedTemplates_AllOrphans
--- PASS: TestCleanOrphanedTemplates_AllOrphans (0.02s)
=== NAME  
=== RUN   TestFTSOptimize
--- PASS: TestFTSOptimize (0.03s)
=== NAME  
=== RUN   TestMaybeVacuum_NoPath
--- PASS: TestMaybeVacuum_NoPath (0.01s)
=== NAME  
=== RUN   TestMaybeVacuum_BelowThreshold
--- PASS: TestMaybeVacuum_BelowThreshold (0.02s)
=== NAME  
=== RUN   TestMaybeVacuum_AboveThreshold
2026/02/20 09:31:27 INFO running VACUUM current_size=155648 last_vacuum_size=1024 ratio=152
2026/02/20 09:31:27 INFO VACUUM completed
--- PASS: TestMaybeVacuum_AboveThreshold (0.53s)
=== NAME  
=== RUN   TestMaybeVacuum_FirstRun
--- PASS: TestMaybeVacuum_FirstRun (0.02s)
=== NAME  
=== RUN   TestTick_LowActivity
--- PASS: TestTick_LowActivity (0.01s)
=== NAME  
=== RUN   TestTick_HighActivity
--- PASS: TestTick_HighActivity (0.02s)
=== NAME  
=== RUN   TestTick_ResetsEventCounter
--- PASS: TestTick_ResetsEventCounter (0.01s)
=== NAME  
=== RUN   TestRun_ContextCancel
2026/02/20 09:31:28 INFO maintenance runner started interval=10ms retention_days=0 batch_size=1000
2026/02/20 09:31:28 WARN WAL checkpoint failed mode=TRUNCATE error="context canceled"
2026/02/20 09:31:28 WARN FTS optimize failed error="context canceled"
2026/02/20 09:31:28 INFO maintenance runner stopping (context cancelled)
--- PASS: TestRun_ContextCancel (0.07s)
=== NAME  
=== RUN   TestRun_StopChannel
2026/02/20 09:31:28 INFO maintenance runner started interval=10ms retention_days=0 batch_size=1000
2026/02/20 09:31:28 INFO maintenance runner stopping (shutdown signal)
--- PASS: TestRun_StopChannel (0.07s)
=== NAME  
=== RUN   TestRun_MultipleTicks
2026/02/20 09:31:28 INFO maintenance runner started interval=10ms retention_days=0 batch_size=1000
2026/02/20 09:31:28 WARN WAL checkpoint failed mode=TRUNCATE error="context canceled"
2026/02/20 09:31:28 WARN FTS optimize failed error="context canceled"
2026/02/20 09:31:28 INFO maintenance runner stopping (context cancelled)
--- PASS: TestRun_MultipleTicks (0.17s)
=== NAME  
=== RUN   TestIntegration_FullMaintenancePass
2026/02/20 09:31:28 INFO retention prune completed deleted=5 cutoff_ms=1763800288363
2026/02/20 09:31:28 INFO cleaned orphaned templates count=1
--- PASS: TestIntegration_FullMaintenancePass (0.02s)
=== NAME  
=== RUN   TestRecordEvent_ThreadSafety
--- PASS: TestRecordEvent_ThreadSafety (0.01s)
=== NAME  
=== RUN   TestConstants
--- PASS: TestConstants (0.00s)
=== NAME  
PASS
ok  	github.com/runger/clai/internal/suggestions/maintenance	3.087s
