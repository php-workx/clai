=== RUN   TestConfigManager_NewConfigManager
=== PAUSE TestConfigManager_NewConfigManager
=== NAME  
=== RUN   TestConfigManager_Load_NotFound
=== PAUSE TestConfigManager_Load_NotFound
=== NAME  
=== RUN   TestConfigManager_Load_ValidConfig
=== PAUSE TestConfigManager_Load_ValidConfig
=== NAME  
=== RUN   TestConfigManager_Load_InvalidYAML
=== PAUSE TestConfigManager_Load_InvalidYAML
=== NAME  
=== RUN   TestConfigManager_Load_MissingRequiredFields
=== PAUSE TestConfigManager_Load_MissingRequiredFields
=== NAME  
=== RUN   TestConfigManager_GetEntriesForFile
=== PAUSE TestConfigManager_GetEntriesForFile
=== NAME  
=== RUN   TestConfigManager_Reload
=== PAUSE TestConfigManager_Reload
=== NAME  
=== RUN   TestConfigManager_ObjectFormat
=== PAUSE TestConfigManager_ObjectFormat
=== NAME  
=== RUN   TestExpandPath
=== PAUSE TestExpandPath
=== NAME  
=== RUN   TestParserTypeConstants
=== PAUSE TestParserTypeConstants
=== NAME  
=== RUN   TestService_NewService
=== PAUSE TestService_NewService
=== NAME  
=== RUN   TestService_NewService_CustomOptions
=== PAUSE TestService_NewService_CustomOptions
=== NAME  
=== RUN   TestService_DiscoverPackageJSON
=== PAUSE TestService_DiscoverPackageJSON
=== NAME  
=== RUN   TestService_DiscoverMakefile
=== PAUSE TestService_DiscoverMakefile
=== NAME  
=== RUN   TestService_DiscoverBoth
=== PAUSE TestService_DiscoverBoth
=== NAME  
=== RUN   TestService_DiscoverEmptyRepo
=== PAUSE TestService_DiscoverEmptyRepo
=== NAME  
=== RUN   TestService_DiscoverNoRepo
=== PAUSE TestService_DiscoverNoRepo
=== NAME  
=== RUN   TestService_TTLCaching
=== PAUSE TestService_TTLCaching
=== NAME  
=== RUN   TestService_InvalidPackageJSON
=== PAUSE TestService_InvalidPackageJSON
=== NAME  
=== RUN   TestService_MakefileTargetRegex
=== PAUSE TestService_MakefileTargetRegex
=== NAME  
=== RUN   TestService_ContextCancellation
=== PAUSE TestService_ContextCancellation
=== NAME  
=== RUN   TestDefaultOptions
=== PAUSE TestDefaultOptions
=== NAME  
=== RUN   TestConstants
=== PAUSE TestConstants
=== NAME  
=== RUN   TestNewParser
=== PAUSE TestNewParser
=== NAME  
=== RUN   TestJSONKeysParser_Parse
=== PAUSE TestJSONKeysParser_Parse
=== NAME  
=== RUN   TestJSONKeysParser_ParseWithDescriptions
=== PAUSE TestJSONKeysParser_ParseWithDescriptions
=== NAME  
=== RUN   TestJSONArrayParser_Parse
=== PAUSE TestJSONArrayParser_Parse
=== NAME  
=== RUN   TestJSONArrayParser_ParseWithDescriptions
=== PAUSE TestJSONArrayParser_ParseWithDescriptions
=== NAME  
=== RUN   TestRegexLinesParser_Parse
=== PAUSE TestRegexLinesParser_Parse
=== NAME  
=== RUN   TestRegexLinesParser_ParseWithDescriptions
=== PAUSE TestRegexLinesParser_ParseWithDescriptions
=== NAME  
=== RUN   TestMakeQPParser_Parse
=== PAUSE TestMakeQPParser_Parse
=== NAME  
=== RUN   TestMakeQPParser_Parse_SkipsSpecialTargets
=== PAUSE TestMakeQPParser_Parse_SkipsSpecialTargets
=== NAME  
=== RUN   TestNavigateJSONPath
=== PAUSE TestNavigateJSONPath
=== NAME  
=== RUN   TestRunner_NewRunner
=== PAUSE TestRunner_NewRunner
=== NAME  
=== RUN   TestRunner_NewRunner_DefaultValues
=== PAUSE TestRunner_NewRunner_DefaultValues
=== NAME  
=== RUN   TestRunner_Run_Success
=== PAUSE TestRunner_Run_Success
=== NAME  
=== RUN   TestRunner_Run_NonZeroExit
=== PAUSE TestRunner_Run_NonZeroExit
=== NAME  
=== RUN   TestRunner_Run_Timeout
=== PAUSE TestRunner_Run_Timeout
=== NAME  
=== RUN   TestRunner_Run_OutputLimit
=== PAUSE TestRunner_Run_OutputLimit
=== NAME  
=== RUN   TestRunner_Run_WorkingDir
=== PAUSE TestRunner_Run_WorkingDir
=== NAME  
=== RUN   TestRunner_Run_NoStdin
=== PAUSE TestRunner_Run_NoStdin
=== NAME  
=== RUN   TestRunner_RunShell
=== PAUSE TestRunner_RunShell
=== NAME  
=== RUN   TestRunner_ContextCancellation
=== PAUSE TestRunner_ContextCancellation
=== NAME  
=== RUN   TestSanitizeEnvironment
=== PAUSE TestSanitizeEnvironment
=== NAME  
=== RUN   TestLimitedBuffer_Write
=== PAUSE TestLimitedBuffer_Write
=== NAME  
=== RUN   TestDiscoveryErrorTracker
=== PAUSE TestDiscoveryErrorTracker
=== NAME  
=== RUN   TestDiscoveryErrorTracker_RingBuffer
=== PAUSE TestDiscoveryErrorTracker_RingBuffer
=== NAME  
=== RUN   TestDefaultRunnerConfig
=== PAUSE TestDefaultRunnerConfig
=== NAME  
=== CONT  TestConfigManager_Load_NotFound
--- PASS: TestConfigManager_Load_NotFound (0.00s)
=== CONT  TestDefaultRunnerConfig
--- PASS: TestDefaultRunnerConfig (0.00s)
=== CONT  TestDiscoveryErrorTracker
=== CONT  TestNewParser
--- PASS: TestDiscoveryErrorTracker (0.00s)
=== CONT  TestConstants
=== RUN   TestNewParser/json_keys
--- PASS: TestConstants (0.00s)
=== CONT  TestLimitedBuffer_Write
=== CONT  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/build:
--- PASS: TestLimitedBuffer_Write (0.00s)
=== CONT  TestDefaultOptions
--- PASS: TestService_MakefileTargetRegex/build: (0.00s)
=== CONT  TestExpandPath
=== CONT  TestService_NewService
--- PASS: TestNewParser/json_keys (0.00s)
=== CONT  TestRunner_Run_OutputLimit
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/test:_deps
--- PASS: TestService_MakefileTargetRegex/test:_deps (0.00s)
=== CONT  TestService_ContextCancellation
=== CONT  TestDiscoveryErrorTracker_RingBuffer
=== CONT  TestRunner_ContextCancellation
=== CONT  TestSanitizeEnvironment
=== CONT  TestRunner_Run_NonZeroExit
=== CONT  TestRunner_RunShell
=== CONT  TestRunner_Run_NoStdin
=== CONT  TestRunner_Run_WorkingDir
--- PASS: TestDefaultOptions (0.00s)
--- PASS: TestExpandPath (0.00s)
=== NAME  TestNewParser
=== RUN   TestNewParser/json_array
--- PASS: TestNewParser/json_array (0.00s)
=== NAME  TestNewParser
=== RUN   TestNewParser/regex_lines
--- PASS: TestDiscoveryErrorTracker_RingBuffer (0.00s)
--- PASS: TestNewParser/regex_lines (0.00s)
=== NAME  TestNewParser
--- PASS: TestSanitizeEnvironment (0.00s)
=== RUN   TestNewParser/make_qp
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/all:_build_test
--- PASS: TestNewParser/make_qp (0.00s)
--- PASS: TestService_MakefileTargetRegex/all:_build_test (0.00s)
=== NAME  TestNewParser
=== RUN   TestNewParser/unknown
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/my-target:
--- PASS: TestNewParser/unknown (0.00s)
=== NAME  TestNewParser
=== RUN   TestNewParser/invalid_regex
--- PASS: TestService_MakefileTargetRegex/my-target: (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/my_target:
--- PASS: TestService_MakefileTargetRegex/my_target: (0.00s)
--- PASS: TestNewParser/invalid_regex (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/target123:
=== NAME  TestNewParser
--- PASS: TestService_MakefileTargetRegex/target123: (0.00s)
--- PASS: TestNewParser (0.00s)
=== CONT  TestRunner_Run_Timeout
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/.PHONY:_all
--- PASS: TestService_MakefileTargetRegex/.PHONY:_all (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/_command
--- PASS: TestService_MakefileTargetRegex/_command (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/#_comment:
--- PASS: TestService_MakefileTargetRegex/#_comment: (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/VAR_=_value
--- PASS: TestService_MakefileTargetRegex/VAR_=_value (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/:=
--- PASS: TestService_MakefileTargetRegex/:= (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/123target:
--- PASS: TestService_MakefileTargetRegex/123target: (0.00s)
=== NAME  TestService_MakefileTargetRegex
=== RUN   TestService_MakefileTargetRegex/-target:
--- PASS: TestService_MakefileTargetRegex/-target: (0.00s)
=== NAME  TestService_MakefileTargetRegex
--- PASS: TestService_MakefileTargetRegex (0.00s)
=== CONT  TestRunner_NewRunner_DefaultValues
--- PASS: TestRunner_NewRunner_DefaultValues (0.00s)
=== CONT  TestRunner_NewRunner
--- PASS: TestRunner_NewRunner (0.00s)
=== CONT  TestNavigateJSONPath
=== RUN   TestNavigateJSONPath/empty_path
--- PASS: TestNavigateJSONPath/empty_path (0.00s)
=== NAME  TestNavigateJSONPath
=== RUN   TestNavigateJSONPath/dot_path
--- PASS: TestNavigateJSONPath/dot_path (0.00s)
=== NAME  TestNavigateJSONPath
=== RUN   TestNavigateJSONPath/single_level
--- PASS: TestNavigateJSONPath/single_level (0.00s)
=== NAME  TestNavigateJSONPath
=== RUN   TestNavigateJSONPath/nested_path
--- PASS: TestNavigateJSONPath/nested_path (0.00s)
=== NAME  TestNavigateJSONPath
=== RUN   TestNavigateJSONPath/path_not_found
--- PASS: TestNavigateJSONPath/path_not_found (0.00s)
=== NAME  TestNavigateJSONPath
=== RUN   TestNavigateJSONPath/path_through_non-object
--- PASS: TestNavigateJSONPath/path_through_non-object (0.00s)
=== NAME  TestNavigateJSONPath
--- PASS: TestNavigateJSONPath (0.00s)
=== CONT  TestMakeQPParser_Parse_SkipsSpecialTargets
--- PASS: TestMakeQPParser_Parse_SkipsSpecialTargets (0.00s)
=== CONT  TestMakeQPParser_Parse
--- PASS: TestRunner_ContextCancellation (0.01s)
=== CONT  TestRegexLinesParser_Parse
=== CONT  TestRunner_Run_Success
=== RUN   TestRegexLinesParser_Parse/simple_pattern
--- PASS: TestMakeQPParser_Parse (0.00s)
--- PASS: TestRegexLinesParser_Parse/simple_pattern (0.00s)
=== NAME  TestRegexLinesParser_Parse
=== RUN   TestRegexLinesParser_Parse/with_description_capture
--- PASS: TestRegexLinesParser_Parse/with_description_capture (0.00s)
--- PASS: TestRunner_Run_NoStdin (0.03s)
--- PASS: TestRunner_RunShell (0.03s)
=== CONT  TestRegexLinesParser_ParseWithDescriptions
--- PASS: TestRegexLinesParser_ParseWithDescriptions (0.00s)
=== NAME  TestRegexLinesParser_Parse
=== CONT  TestJSONArrayParser_Parse
=== RUN   TestRegexLinesParser_Parse/no_matches
=== RUN   TestJSONArrayParser_Parse/string_array
--- PASS: TestRunner_Run_WorkingDir (0.04s)
=== CONT  TestJSONKeysParser_ParseWithDescriptions
--- PASS: TestJSONKeysParser_ParseWithDescriptions (0.00s)
=== CONT  TestJSONKeysParser_Parse
=== RUN   TestJSONKeysParser_Parse/simple_object
--- PASS: TestJSONArrayParser_Parse/string_array (0.00s)
=== NAME  TestJSONArrayParser_Parse
=== RUN   TestJSONArrayParser_Parse/object_array_with_name_field
--- PASS: TestJSONKeysParser_Parse/simple_object (0.00s)
=== NAME  TestJSONKeysParser_Parse
=== RUN   TestJSONKeysParser_Parse/nested_path
--- PASS: TestJSONArrayParser_Parse/object_array_with_name_field (0.00s)
=== NAME  TestJSONArrayParser_Parse
=== RUN   TestJSONArrayParser_Parse/mixed_array
--- PASS: TestJSONKeysParser_Parse/nested_path (0.00s)
=== CONT  TestJSONArrayParser_ParseWithDescriptions
--- PASS: TestJSONArrayParser_Parse/mixed_array (0.00s)
=== NAME  TestJSONArrayParser_Parse
--- PASS: TestJSONArrayParser_ParseWithDescriptions (0.00s)
=== NAME  TestJSONKeysParser_Parse
=== CONT  TestParserTypeConstants
--- PASS: TestParserTypeConstants (0.00s)
2026/02/20 09:31:25 WARN discovery runner non-zero exit command=sh args="[-c exit 42]" exit_code=42 stderr=""
=== CONT  TestConfigManager_GetEntriesForFile
=== RUN   TestJSONKeysParser_Parse/root_object
--- PASS: TestRunner_Run_Success (0.03s)
--- PASS: TestRegexLinesParser_Parse/no_matches (0.00s)
--- PASS: TestJSONKeysParser_Parse/root_object (0.00s)
=== NAME  TestJSONKeysParser_Parse
=== RUN   TestJSONKeysParser_Parse/invalid_json
--- PASS: TestRunner_Run_NonZeroExit (0.04s)
=== RUN   TestJSONArrayParser_Parse/invalid_json
--- PASS: TestJSONArrayParser_Parse/invalid_json (0.00s)
=== NAME  TestJSONArrayParser_Parse
=== RUN   TestJSONArrayParser_Parse/path_not_array
=== NAME  TestRegexLinesParser_Parse
=== RUN   TestRegexLinesParser_Parse/empty_lines
--- PASS: TestRegexLinesParser_Parse/empty_lines (0.00s)
=== NAME  TestRegexLinesParser_Parse
--- PASS: TestRegexLinesParser_Parse (0.03s)
--- PASS: TestJSONKeysParser_Parse/invalid_json (0.00s)
=== CONT  TestConfigManager_Reload
--- PASS: TestService_NewService (0.04s)
=== CONT  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/missing_file_pattern
=== CONT  TestConfigManager_Load_InvalidYAML
=== CONT  TestConfigManager_ObjectFormat
2026/02/20 09:31:25 INFO discovery config loaded path=/var/folders/cw/7cjc3nt55wl119pn0t4z7rmc0000gn/T/TestConfigManager_Reload1499369307/001/discovery.yaml entries=1
--- PASS: TestConfigManager_Load_MissingRequiredFields/missing_file_pattern (0.00s)
=== NAME  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/missing_kind
2026/02/20 09:31:25 INFO discovery config loaded path=/var/folders/cw/7cjc3nt55wl119pn0t4z7rmc0000gn/T/TestConfigManager_Reload1499369307/001/discovery.yaml entries=2
2026/02/20 09:31:25 INFO discovery config loaded path=/var/folders/cw/7cjc3nt55wl119pn0t4z7rmc0000gn/T/TestConfigManager_GetEntriesForFile3717741740/001/discovery.yaml entries=3
2026/02/20 09:31:25 WARN discovery runner output exceeded limit command=sh args="[-c yes | head -1000]" limit=10
=== NAME  TestJSONKeysParser_Parse
=== RUN   TestJSONKeysParser_Parse/path_not_found
=== CONT  TestConfigManager_Load_ValidConfig
--- PASS: TestJSONArrayParser_Parse/path_not_array (0.00s)
--- PASS: TestRunner_Run_OutputLimit (0.04s)
=== CONT  TestConfigManager_NewConfigManager
--- PASS: TestConfigManager_NewConfigManager (0.00s)
--- PASS: TestConfigManager_Load_MissingRequiredFields/missing_kind (0.00s)
--- PASS: TestConfigManager_GetEntriesForFile (0.00s)
=== CONT  TestService_DiscoverBoth
--- PASS: TestJSONKeysParser_Parse/path_not_found (0.00s)
=== NAME  TestJSONKeysParser_Parse
=== RUN   TestJSONKeysParser_Parse/path_not_object
--- PASS: TestConfigManager_Reload (0.00s)
--- PASS: TestJSONKeysParser_Parse/path_not_object (0.00s)
=== NAME  TestJSONKeysParser_Parse
=== CONT  TestService_InvalidPackageJSON
--- PASS: TestJSONKeysParser_Parse (0.01s)
=== CONT  TestService_DiscoverNoRepo
=== NAME  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/missing_runner
=== NAME  TestJSONArrayParser_Parse
--- PASS: TestJSONArrayParser_Parse (0.01s)
=== CONT  TestService_DiscoverEmptyRepo
2026/02/20 09:31:25 INFO discovery config loaded path=/var/folders/cw/7cjc3nt55wl119pn0t4z7rmc0000gn/T/TestConfigManager_Load_ValidConfig2877437096/001/discovery.yaml entries=2
2026/02/20 09:31:25 INFO discovery config loaded path=/var/folders/cw/7cjc3nt55wl119pn0t4z7rmc0000gn/T/TestConfigManager_ObjectFormat700272169/001/discovery.yaml entries=1
--- PASS: TestConfigManager_Load_ValidConfig (0.00s)
--- PASS: TestConfigManager_Load_InvalidYAML (0.00s)
=== CONT  TestService_TTLCaching
--- PASS: TestConfigManager_ObjectFormat (0.01s)
=== CONT  TestService_NewService_CustomOptions
=== CONT  TestService_DiscoverMakefile
--- PASS: TestConfigManager_Load_MissingRequiredFields/missing_runner (0.00s)
=== NAME  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/missing_parser_type
--- PASS: TestConfigManager_Load_MissingRequiredFields/missing_parser_type (0.00s)
=== NAME  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/json_keys_missing_path
--- PASS: TestConfigManager_Load_MissingRequiredFields/json_keys_missing_path (0.00s)
=== NAME  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/regex_lines_missing_pattern
--- PASS: TestConfigManager_Load_MissingRequiredFields/regex_lines_missing_pattern (0.00s)
=== NAME  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/invalid_regex_pattern
--- PASS: TestConfigManager_Load_MissingRequiredFields/invalid_regex_pattern (0.00s)
=== NAME  TestConfigManager_Load_MissingRequiredFields
=== RUN   TestConfigManager_Load_MissingRequiredFields/unknown_parser_type
2026/02/20 09:31:25 WARN Makefile discovery failed error="context canceled" repo=/var/folders/cw/7cjc3nt55wl119pn0t4z7rmc0000gn/T/clai-test-repo-2956949115
--- PASS: TestConfigManager_Load_MissingRequiredFields/unknown_parser_type (0.00s)
=== NAME  TestConfigManager_Load_MissingRequiredFields
--- PASS: TestConfigManager_Load_MissingRequiredFields (0.02s)
=== CONT  TestService_DiscoverPackageJSON
--- PASS: TestService_ContextCancellation (0.06s)
2026/02/20 09:31:25 WARN discovery runner timeout command=sleep args=[5] timeout=50ms
--- PASS: TestRunner_Run_Timeout (0.06s)
--- PASS: TestService_DiscoverNoRepo (0.05s)
2026/02/20 09:31:25 WARN package.json discovery failed error="invalid character 'o' in literal null (expecting 'u')" repo=/var/folders/cw/7cjc3nt55wl119pn0t4z7rmc0000gn/T/clai-test-repo-1673724147
--- PASS: TestService_DiscoverEmptyRepo (0.05s)
--- PASS: TestService_NewService_CustomOptions (0.05s)
--- PASS: TestService_TTLCaching (0.05s)
--- PASS: TestService_InvalidPackageJSON (0.05s)
--- PASS: TestService_DiscoverBoth (0.05s)
--- PASS: TestService_DiscoverPackageJSON (0.04s)
--- PASS: TestService_DiscoverMakefile (0.05s)
PASS
ok  	github.com/runger/clai/internal/suggestions/discovery	2.784s
